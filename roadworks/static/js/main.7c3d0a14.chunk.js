(this["webpackJsonphe-roadworks"]=this["webpackJsonphe-roadworks"]||[]).push([[0],{30:function(e,t,a){e.exports=a(84)},83:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(6),c=a.n(o),l=a(1),s=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("h1",null,"Roadworks"),r.a.createElement("nav",null,r.a.createElement("a",{href:"https://reallybigshoe.co.uk"},"Home"),r.a.createElement("a",{href:"https://reallybigshoe.co.uk/visualiser"},"Palette Visualiser"),r.a.createElement("a",{href:"http://spacex.reallybigshoe.co.uk"},"SpaceX Info"),r.a.createElement("a",{href:"http://countdown.reallybigshoe.co.uk"},"Countdown Magician"),r.a.createElement("a",{href:"https://github.com/JulianNicholls",target:"_blank",rel:"noopener noreferrer"},"GitHub"),r.a.createElement("a",{href:"https://twitter.com/ReallyBigShoeUK",target:"_blank",rel:"noopener noreferrer"},"Twitter")))},u=function(){return r.a.createElement("section",{className:"introduction"},r.a.createElement("p",null,"In 2011, the UK's"," ",r.a.createElement("a",{href:"https://www.gov.uk/government/organisations/department-for-transport",title:"DfT Site"},"Department for Transport (DfT)")," ","began to issue datasets for public use under the"," ",r.a.createElement("a",{href:"https://www.nationalarchives.gov.uk/doc/open%2Dgovernment%2Dlicence/",title:"Usage Licence"},"Open\xa0Government\xa0License"),". One of the first of these was planned roadworks issued by the Highways Agency (now Highways England)."),r.a.createElement("p",null,"These are the latest planned roadworks on Highways England's roads, loaded from the latest data file on"," ",r.a.createElement("a",{href:"https://data.gov.uk/dataset/5b3267d8-4307-4eef-a9af-3a4c28224694/planned-road-works-on-the-he-road-network",title:"dataset"},"this\xa0page"),"."),r.a.createElement("p",null,"You can find information by road number, or search descriptions. The listed roadworks have already started or will start within the next two weeks. Roadworks which should have been completed at least a week ago are not shown (hopeful, I know)."))},i=a(86),d=a(4),p=a.n(d),h=a(7),m=(new Date).setHours(0,0,0),f=m-6048e5,b=m+12096e5,v=function(e){return Date.parse(e)>=f},w=r.a.createContext(),g=function(){var e=Object(n.useContext)(w);if(void 0===e)throw new Error("useRoadworks() must be used within a RoadworksProvider block");return e},E=function(){var e=g(),t=e.roads,a=e.selected,o=e.setSelected,c=e.setSearchText,s=Object(n.useState)(""),u=Object(l.a)(s,2),d=u[0],p=u[1],h=Object(n.useState)(a),m=Object(l.a)(h,2),f=m[0],b=m[1];Object(i.a)((function(){d.length>1?(o(""),c(d)):0===d.length&&f&&o(f)}),600,[d]);return r.a.createElement("section",{className:"selection-panel"},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"road"},"Road"),r.a.createElement("select",{id:"road",onChange:function(e){o(e.target.value),b(e.target.value),p(""),c("")},value:a},r.a.createElement("option",{value:""},"\xa0"),t.map((function(e,t){var a=e.roads;return r.a.createElement("option",{key:t,value:a},a)})))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"location"},"Search"),r.a.createElement("input",{type:"search",id:"location",value:d,onChange:function(e){return p(e.target.value)}})))},y=function(e){return new Date(e).toLocaleDateString("en-gb",{day:"2-digit",month:"short",year:"numeric"})},k=function(e){var t,a=e.item,n=e.setMapCentre,o=a.roads,c=a.description,l=a.startDate,s=a.endDate,u=a.expectedDelay,i=a.closureType,d=a.centreEasting,p=a.centreNorthing,h="A"===o[0]?"a-road":"motorway",f=(t=s,Date.parse(t)<m),b=function(e){return Date.parse(e)>m}(l);return r.a.createElement("article",{className:h},r.a.createElement("header",null,r.a.createElement("h2",null,o),r.a.createElement("span",null,u),r.a.createElement("span",null,i)),r.a.createElement("p",null,"Location: ",d," ",p,r.a.createElement("button",{className:"map-button",onClick:function(){return n({east:d,north:p})}},"Map")),r.a.createElement("p",null,c),r.a.createElement("span",{className:"duration"},"Duration: ",y(l)," - ",y(s)," ",f&&r.a.createElement("span",{className:"duration-extra"},"(should be complete)"),b&&r.a.createElement("span",{className:"duration-extra"},"(Starting soon)")))},O=function(e){var t=e.setMapCentre,a=g().selectedRoadworks();return r.a.createElement("section",null,0===a.length&&r.a.createElement("h2",{className:"centred"},"No matching roadworks"),a.map((function(e,a){return r.a.createElement(k,{item:e,key:a,setMapCentre:t})})))},j=a(27),S=a(28),x=a.n(S),D={alignItems:"center",background:"rgba(0, 0, 0, 0.7)",color:"white",display:"flex",fontSize:"1.3rem",height:"25vh",justifyContent:"center",left:"35vw",position:"fixed",top:"35vh",width:"25vw"},N=function(){return r.a.createElement("div",{className:"loading-panel",style:D},r.a.createElement("h2",null,"Loading..."))},C=a(3),L=a.n(C),R=a(29),P=a.n(R);function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(a,!0).forEach((function(t){Object(j.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var I="http://nearby.org.uk/api/convert.php?key=".concat("80e885ee3dbdd7","&output=text&p=");L.a.setAppElement("#root"),L.a.defaultStyles=T({},L.a.defaultStyles,{overlay:T({},L.a.defaultStyles.overlay,{backgroundColor:"rgba(0, 0, 0, 0.4)"}),content:T({},L.a.defaultStyles.content,{top:"10vh",bottom:"10vh",left:"10vw",right:"10vw"})});var H=function(){return r.a.createElement("span",{className:"pointer",role:"img","aria-label":"roadworks-location"},"\ud83d\udc46")},U=function(e){var t=e.centre,a=Object(n.useState)(!1),o=Object(l.a)(a,2),c=o[0],s=o[1],u=Object(n.useState)(!1),i=Object(l.a)(u,2),d=i[0],m=i[1],f=Object(n.useState)({lat:0,lng:0}),b=Object(l.a)(f,2),v=b[0],w=b[1];return Object(n.useEffect)((function(){var e=function(){var e=Object(h.a)(p.a.mark((function e(){var a,n,r,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,n="".concat("https://cors-anywhere.herokuapp.com","/").concat(I).concat(t.east,",").concat(t.north),e.next=5,x.a.get(n);case 5:200===(a=e.sent).status?(r=a.data.split("\n").reduce((function(e,t){if(t.startsWith("ll")){var a=t.split(",");return{lat:parseFloat(a[2]),lng:parseFloat(a[3])}}return e}),{lat:0,lng:0}),o=r.lat,c=r.lng,w({lat:o,lng:c}),m(!1),s(!0)):console.warn({fullURL:n,response:a}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),console.error({error:e.t0}),console.warn({fullURL:n,response:a}),s(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();0===t.north&&0===t.east?s(!1):e()}),[t]),r.a.createElement(r.a.Fragment,null,d?r.a.createElement(N,null):r.a.createElement(L.a,{isOpen:c,onRequestClose:function(){return s(!1)},contentLabel:"Roadworks Map",style:{overlay:{backgroundColor:"rgba(0, 0, 0, 0.4)"},content:{top:"15vh",bottom:"15vh",left:"15vw",right:"15vw"}}},r.a.createElement("div",{id:"map"},r.a.createElement(P.a,{bootstrapURLKeys:{key:"AIzaSyDvp7wjzXMDeNM2w63LrdtG-bN4zqqPnuM"},defaultCenter:v,defaultZoom:15},r.a.createElement(H,v)))))};var A=function(){var e=Object(n.useState)({east:0,north:0}),t=Object(l.a)(e,2),a=t[0],o=t[1];return r.a.createElement("div",{className:"App"},r.a.createElement(s,null),r.a.createElement("main",{className:"container"},r.a.createElement("div",{className:"top-section"},r.a.createElement(u,null),r.a.createElement(E,null)),r.a.createElement(O,{setMapCentre:o})),r.a.createElement(U,{centre:a}))};a(82),a(83);c.a.render(r.a.createElement((function(e){var t=e.children,a=Object(n.useState)([]),o=Object(l.a)(a,2),c=o[0],s=o[1],u=Object(n.useState)([]),i=Object(l.a)(u,2),d=i[0],m=i[1],f=Object(n.useState)(""),g=Object(l.a)(f,2),E=g[0],y=g[1],k=Object(n.useState)(""),O=Object(l.a)(k,2),j=O[0],S=O[1],x=function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/data/roadworks.json");case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=a.filter((function(e){var t,a=e.startDate,n=e.endDate;return t=a,Date.parse(t)<=b&&v(n)})),s(n),r={roads:"",index:0},o=n.reduce((function(e,t,a){var n=t.roads;if(n!==r.roads){var o={roads:n,index:a};e.push(o),r=o}return e}),[]),m(o),y(o[0].roads),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){x()}),[]);var D={roadworks:c,roads:d,selected:E,searchText:j,selectedRoadworks:function(){var e=[];if(""!==E)for(var t=d.findIndex((function(e){return e.roads===E})),a=t<d.length-1?d[t+1].index:c.length,n=d[t].index;n<a;++n)e.push(c[n]);else if(""!==j){var r=j.toLocaleLowerCase();e=c.filter((function(e){return e.description.toLocaleLowerCase().includes(r)}))}return e},setSelected:y,setSearchText:S};return r.a.createElement(w.Provider,{value:D},t)}),null,r.a.createElement(A,null)),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.7c3d0a14.chunk.js.map